# Параллельное выполнение программ

Примитивы синхронизации и типовые шаблоны

---

## Введение

- Почему параллелизм важен?
- Проблемы при параллельном выполнении:
  - Гонки данных (data races)
  - Непредсказуемое поведение
- Необходимость синхронизации

---

## Основные понятия

- Поток (thread)
- Критическая секция (critical section)
- Взаимное исключение (mutual exclusion)
- Состояние гонки (race condition)

---

## Примитивы синхронизации — Обзор

- Mutex (мьютекс)
- Semaphore (семафор)
- Condition Variable (условная переменная)
- Atomic Types (атомарные типы)
- Lock-free и wait-free структуры

---

## Mutex (мьютекс)

- Гарантия, что только один поток в критической секции
- Пример:
  ```cpp
  std::lock_guard<std::mutex> lock(mtx);
  // критическая секция
  ```
- Проблемы: дедлоки, блокировки

---

## Semaphore (семафор)

- Счётчик для ограничения числа потоков
- Двоичный (бинарный) vs. счётный семафор
- Пример: ограничение числа активных задач

---

## Condition Variable

- Ожидание изменения состояния
- Взаимодействие с мьютексом
- Пример: шаблон "производитель-потребитель"

---

## Atomic Types

- Операции над переменной — атомарны
- Пример: `std::atomic<int>`
- Используется для: счётчиков, флагов

---

## Шаблон: Producer-Consumer

- Описание: один поток производит, другой потребляет
- Реализация: очередь + мьютекс + условная переменная

---

## Шаблон: Readers-Writer Lock

- Сценарий: много читающих, мало пишущих
- Специальный тип блокировки
- Пример: кэш, таблица настроек

---

## Lock-Free и Wait-Free

- Структуры данных без блокировок
- Преимущества: избегание дедлоков, высокая производительность
- Пример: lock-free очередь

---

## Дедлоки (Deadlocks)

- Что такое: два или более потока ждут друг друга
- Как избежать: порядок захвата, таймауты

---

## Лучшие практики

- Минимизировать использование блокировок
- RAII: `lock_guard` в C++
- Избегать вложенных блокировок
- Использовать атомарные операции для простых задач

---

## Заключение

- Параллелизм требует осторожного подхода
- Правильный выбор примитивов критически важен
- Понимание шаблонов помогает избежать ошибок

---

## Вопросы?

Спасибо за внимание!
